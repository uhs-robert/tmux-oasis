# oasis_tmux.conf
# Main theme loader with automatic variant selection

# Default to lagoon_dark if user hasn't specified a flavor
set -ogq @oasis_flavor "lagoon_dark"

# Normalize flavor name - append _dark suffix if no variant specified for dual-mode themes
# Dual-mode themes: abyss, cactus, canyon, desert, dune, lagoon, mirage, midnight, night, rose, sol, starlight, twilight
# Single-mode themes: dawn, dawnlight, day, dusk, dust
%hidden OASIS_FLAVOR="#{@oasis_flavor}"
%if "#{m/r:^(abyss|cactus|canyon|desert|dune|lagoon|mirage|midnight|night|rose|sol|starlight|twilight)$,#{@oasis_flavor}}"
  set -gF @oasis_flavor "#{@oasis_flavor}_dark"
%endif

# Extract theme name for directory path
%if "#{m/r:^(abyss|cactus|canyon|desert|dune|lagoon|mirage|midnight|night|rose|sol|starlight|twilight)_(dark|light(_[1-5])?)$,#{@oasis_flavor}}"
  set -gF @oasis_theme_dir "#{s/_(dark|light(_[1-5])?)$//:@oasis_flavor}"
%else
  set -gF @oasis_theme_dir "#{@oasis_flavor}"
%endif

# Load the selected theme variant from its directory
source -F "#{d:current_file}/themes/#{@oasis_theme_dir}/oasis_#{@oasis_flavor}.conf"

# Basic tmux styling
set -gF message-style "fg=#{@thm_primary},bg=#{@thm_mantle},align=centre"
set -gF message-command-style "fg=#{@thm_secondary},bg=#{@thm_mantle},align=centre"
set -gF mode-style "bg=#{@thm_surface},fg=#{@thm_fg},bold"
set -gF clock-mode-colour "#{@thm_blue}"

# Menu styling (tmux 3.4+)
%if "#{>=:#{version},3.4}"
  set -gF menu-selected-style "fg=#{@thm_fg},bold,bg=#{@thm_surface}"
%endif

# Popup styling (tmux 3.4+)
%if "#{>=:#{version},3.4}"
  set -gF popup-style "bg=#{@thm_core},fg=#{@thm_fg}"
  set -gF popup-border-style "fg=#{@thm_surface}"
%endif


# Pane border styling
setw -g pane-border-status off
setw -g pane-border-format ""
setw -g pane-active-border-style "bg=#{@thm_mantle},fg=#{@thm_mantle}"
setw -g pane-border-style "bg=#{@thm_mantle},fg=#{@thm_surface}"
setw -g pane-border-lines single

# Load status line configuration
source -F "#{d:current_file}/status_modules/status_line.conf"
