# oasis_tmux.conf
# Main theme loader with automatic variant selection

# Default to lagoon_dark if user hasn't specified a flavor
set -ogq @oasis_flavor "lagoon_dark"

# Mode format: "short" (single letter), "full" (complete word), "icon" (Nerd Font icons), or "custom" (user-defined)
set -ogq @oasis_mode_format "full"

# Custom mode labels (only used when @oasis_mode_format is "custom")
# Users can override any of these to customize the mode indicator
set -ogq @oasis_mode_custom_normal "NORMAL"
set -ogq @oasis_mode_custom_command "COMMAND"
set -ogq @oasis_mode_custom_copy "COPY"
set -ogq @oasis_mode_custom_view "VIEW"
set -ogq @oasis_mode_custom_choose "CHOOSE"
set -ogq @oasis_mode_custom_options "OPTIONS"
set -ogq @oasis_mode_custom_clock "CLOCK"
set -ogq @oasis_mode_custom_zoom "ZOOM"

# Normalize flavor name - append _dark suffix if no variant specified for dual-mode themes
# Dual-mode themes: abyss, cactus, canyon, desert, dune, lagoon, mirage, midnight, night, rose, sol, starlight, twilight
# Single-mode themes: dawn, dawnlight, day, dusk, dust
%hidden OASIS_FLAVOR="#{@oasis_flavor}"
%if "#{m/r:^(abyss|cactus|canyon|desert|dune|lagoon|mirage|midnight|night|rose|sol|starlight|twilight)$,#{@oasis_flavor}}"
  set -gF @oasis_flavor "#{@oasis_flavor}_dark"
%endif

# Determine theme path based on variant type
# Dark themes: themes/dark/oasis_*_dark.conf
# Light themes: themes/light/N/oasis_*_light_N.conf
%if "#{m/r:_dark$,#{@oasis_flavor}}"
  set -gF @oasis_theme_path "#{d:current_file}/themes/dark/oasis_#{@oasis_flavor}.conf"
%elif "#{m/r:_light_([1-5])$,#{@oasis_flavor}}"
  set -gF @oasis_theme_path "#{d:current_file}/themes/light/#{s/.*_light_([1-5])$/\\1/:@oasis_flavor}/oasis_#{@oasis_flavor}.conf"
%else
  set -gF @oasis_theme_path "#{d:current_file}/themes/dark/oasis_#{@oasis_flavor}.conf"
%endif

# Load the selected theme variant
source -F "#{@oasis_theme_path}"

# Basic tmux styling
set -gF message-style "fg=#{@thm_primary},bg=#{@thm_mantle},align=centre"
set -gF message-command-style "fg=#{@thm_secondary},bg=#{@thm_mantle},align=centre"
set -gF mode-style "bg=#{@thm_visual},fg=#{@thm_fg},bold"
set -gF clock-mode-colour "#{@thm_blue}"

# Menu styling (tmux 3.4+)
%if "#{>=:#{version},3.4}"
  set -gF menu-selected-style "fg=#{@thm_fg},bold,bg=#{@thm_surface}"
%endif

# Popup styling (tmux 3.4+)
%if "#{>=:#{version},3.4}"
  set -gF popup-style "bg=#{@thm_core},fg=#{@thm_fg}"
  set -gF popup-border-style "fg=#{@thm_surface}"
%endif


# Pane border styling
setw -g pane-border-status off
setw -g pane-border-format ""
setw -g pane-active-border-style "bg=#{@thm_mantle},fg=#{@thm_mantle}"
setw -g pane-border-style "bg=#{@thm_mantle},fg=#{@thm_surface}"
setw -g pane-border-lines single

# Load status line configuration
source -F "#{d:current_file}/status/status_line.conf"
